<html>
<head>
  <meta charset="utf-8">
  <title>Value of reef and mangrove coastal protection from storms in Florida Keys</title>
</head>
<body>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>

<div id="container" style="min-width: 310px; max-width: 600px; height: 400px; margin: 0 auto"></div>

Important ecosystem services are provided by mangroves and coral reef structure in the form of coastal protection. Both mangrove lined shorelines and coral reef structure provide important wave attenuation and storm surge mitigation during storms and extreme events, and the predicted value of coastal protection by these habitats for storm events is represented here.

Source: <a href="https://www.usgs.gov/centers/pcmsc/science/role-reefs-coastal-protection?qt-science_center_objects=0#qt-science_center_objects">Storlazzi et al., USGS/UCSC report</a>

<script>
  csv   = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ09vcYWHMZd5VZGsXlASMI9z_uX4ome_bvy5lw0CM3YgSrw9eSbUoc-1ZswYpbTVs3ct3ygVSRHFMV/pub?gid=348646580&single=true&output=csv';
  title = 'Value of reef and mangrove coastal protection from storms in Florida Keys';
  icon  = 'hurricane-coastal-protections';

  x_axis_label = "Year";
  y_axis_label = 'Total Value of Economic Activity Protected by Florida Keys Coral Reefs (in 2010 dollars)';
  year_max     = 0;      // TODO: to use JS to read in max year, presumably 1st column
  years_band   = 5;
  
  if (csv == 'NA'){
    document.getElementById('container').innerHTML = "<em>No data</em> yet assigned to icon <b>" + icon + "</b>. This needs to be specified in this Google Sheet: <a href='https://docs.google.com/spreadsheets/d/1_o8HOiZ_35uajupEsw6xLSsneTBTeLh0bqvFQvMpBNY/edit#gid=0'>icons to data | fk-esr-info</a>."
  } 
  //The chart for hurricane coastal protections is a bar chart and has to be handled differently than all other modal windows
  else if (icon == 'hurricane-coastal-protections') {
        Highcharts.chart('container', {
          chart: {type: 'column'},
      title: {text: title},
      credits: {enabled: false},
      data: {csvURL: csv},
      xAxis: {title: {text: "Storm Frequency"}},
      yAxis: {title: {text: "2010 Dollars"}},
      legend: {enabled: false},
});
  }
  else {
    Highcharts.chart('container', {
      title: {text: title},
      credits: {enabled: false},
      data: {
        csvURL: csv,
        firstRowAsNames: true,
        startRow: 0 }, 
      series: [{
        name: 'value', 
        showInLegend: true,
        marker: {
          enabled: false,
          fillColor: 'white',
          lineWidth: 1,
          lineColor: Highcharts.getOptions().colors[0] }}],
      xAxis: {
        plotBands: [{
          from: year_max - years_band, 
          to: year_max,
          color: '#DEDEFF'}],
        title: {text: x_axis_label}},
      yAxis: {
        title: {text: y_axis_label} }});
  }
</script>

</body>
</html>
