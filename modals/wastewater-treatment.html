<html>
<head>
  <meta charset="utf-8">
  <title>Housing units connected to wastewater treatment</title>
</head>
<body>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>

<div id="container" style="min-width: 310px; max-width: 600px; height: 400px; margin: 0 auto"></div>

Management of sewage and wastewater was determined to be an important indicator of how human activites and presence put pressure
on the ecosystem condition of the archipelago of the Florida Keys. A major effort was undertaken in the Keys to connect all household to a central sewer system
rather than using cesspits, septic tanks and other individual wastewater containment susceptible to damage and leakage
of wastewater into Sanctuary waters. In the last five years, almost all household have been connected to the central sewer
system, a human management activity that reduces pressure on Sanctuary condition and resources.

Source: <a href="https://www.fkaa.com/">Monroe County Social Services Department, Florida Keys Aqueduct Authority</a>

<script>
  csv   = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQpgs8TjUPdfdnEgu3Lu1gseyxtFL2TSGfXfbHYVr02Y8s4fm8tIchA58-f1bT8TSvtTpgLhlDtu-et/pub?gid=624703045&single=true&output=csv';
  title = 'Housing units connected to wastewater treatment';
  icon  = 'wastewater-treatment';

  x_axis_label = "Year";
  y_axis_label = 'Percent of Households';
  year_max     = 2019;      // TODO: to use JS to read in max year, presumably 1st column
  years_band   = 5;
  
  if (csv == 'NA'){
    document.getElementById('container').innerHTML = "<em>No data</em> yet assigned to icon <b>" + icon + "</b>. This needs to be specified in this Google Sheet: <a href='https://docs.google.com/spreadsheets/d/1_o8HOiZ_35uajupEsw6xLSsneTBTeLh0bqvFQvMpBNY/edit#gid=0'>icons to data | fk-esr-info</a>."
  } 
  //The chart for hurricane coastal protections is a bar chart and has to be handled differently than all other modal windows
  else if (icon == 'hurricane-coastal-protections') {
        Highcharts.chart('container', {
          chart: {type: 'column'},
      title: {text: title},
      credits: {enabled: false},
      data: {csvURL: csv},
      xAxis: {title: {text: "Storm Frequency"}},
      yAxis: {title: {text: "2010 Dollars"}},
      legend: {enabled: false},
});
  }
  else {
    Highcharts.chart('container', {
      title: {text: title},
      credits: {enabled: false},
      data: {
        csvURL: csv,
        firstRowAsNames: true,
        startRow: 0 }, 
      series: [{
        name: 'value', 
        showInLegend: true,
        marker: {
          enabled: false,
          fillColor: 'white',
          lineWidth: 1,
          lineColor: Highcharts.getOptions().colors[0] }}],
      xAxis: {
        plotBands: [{
          from: year_max - years_band, 
          to: year_max,
          color: '#DEDEFF'}],
        title: {text: x_axis_label}},
      yAxis: {
        title: {text: y_axis_label} }});
  }
</script>

</body>
</html>
