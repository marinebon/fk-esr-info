<html>
<head>
  <meta charset="utf-8">
  <title>Spiny lobster commercial fishing trips from Monroe County</title>
</head>
<body>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>

<div id="container" style="min-width: 310px; max-width: 600px; height: 400px; margin: 0 auto"></div>

The selected economically important species referred to data collected by Florida
Fish and Wildlife Conservation Commission and NOAA National Marine Fisheries Service, showing the number of trips of
top fish groups for revenue: lobster  and stone crab. Declining trends were seen in the number of lobster trips in the past five years, and all fisheries experienced
declines below one standard deviation for some period since 2008.

Source: <a href="https://www.fisheries.noaa.gov/region/southeast#science">NOAA National Marine Fisheries Service</a>

<script>
  csv   = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQnH9UDDjeDWpthgRXpK7lUl1TsmuSEYJtOivb6w3Us_XCIptR2UYW7P8gOsSs7dWrHc4ZNNlUH0wjp/pub?gid=499105770&single=true&output=csv';
  title = 'Spiny lobster commercial fishing trips from Monroe County';
  icon  = 'lobster';

  x_axis_label = "Year";
  y_axis_label = 'Number of spiny lobster commercial fishing trips';
  year_max     = 2018;      // TODO: to use JS to read in max year, presumably 1st column
  years_band   = 5;
  
  if (csv == 'NA'){
    document.getElementById('container').innerHTML = "<em>No data</em> yet assigned to icon <b>" + icon + "</b>. This needs to be specified in this Google Sheet: <a href='https://docs.google.com/spreadsheets/d/1_o8HOiZ_35uajupEsw6xLSsneTBTeLh0bqvFQvMpBNY/edit#gid=0'>icons to data | fk-esr-info</a>."
  } 
  //The chart for hurricane coastal protections is a bar chart and has to be handled differently than all other modal windows
  else if (icon == 'hurricane-coastal-protections') {
        Highcharts.chart('container', {
          chart: {type: 'column'},
      title: {text: title},
      credits: {enabled: false},
      data: {csvURL: csv},
      xAxis: {title: {text: "Storm Frequency"}},
      yAxis: {title: {text: "2010 Dollars"}},
      legend: {enabled: false},
});
  }
  else {
    Highcharts.chart('container', {
      title: {text: title},
      credits: {enabled: false},
      data: {
        csvURL: csv,
        firstRowAsNames: true,
        startRow: 0 }, 
      series: [{
        name: 'value', 
        showInLegend: true,
        marker: {
          enabled: false,
          fillColor: 'white',
          lineWidth: 1,
          lineColor: Highcharts.getOptions().colors[0] }}],
      xAxis: {
        plotBands: [{
          from: year_max - years_band, 
          to: year_max,
          color: '#DEDEFF'}],
        title: {text: x_axis_label}},
      yAxis: {
        title: {text: y_axis_label} }});
  }
</script>

</body>
</html>
