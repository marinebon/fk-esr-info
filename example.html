<!DOCTYPE html>
<html >
  <head>
     
  	<script src="https://d3js.org/d3.v5.min.js"></script>
  </head>
  <body>

	<div id="svg1"></div>

	  
    <script type="text/javascript">
		link_svg(svg_test = "assets/svg/FKIEA_Ecosystem.svg", csv_test = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSAROGVpYB58Zkr8P0iwJdTMRPNLZtJ07IyUn-dQ62C2HMuCEScyl8x7urCD7QbRXQYSIJwDn_wku9G/pub?gid=0&single=true&output=csv");


		// append div for tooltip
		var tooltip_div = d3.select("body").append("div")
		  .attr("class", "tooltip")
		  .style("opacity", 0);

		//here's a very stripped down version of the original function just to illustrate the problem
		function link_svg(svg_test, csv_test, hover_color = 'yellow', width = '100%', height = '100%', modal_id = 'modal') {

				d3.xml(svg_test).then((f) => {
			    
				    var div = d3.select('#svg1');
				  
				    var f_child = div.node().appendChild(f.documentElement);

				    // get handle to svg
				    var h = d3.select(f_child);
				    
				    // full size
				    h.attr('width', width)
				     .attr('height', height);

			        function handleMouseOver(){
			        	console.log(d3.event.pageX);
			            console.log(d3.event.pageY);

						d3.select('#mangroves')
				            .style("stroke-width", 2)
				            .style("stroke", hover_color);
			          
			          tooltip_div.transition()
			            .duration(200)
			            .style("opacity", 0.8);
			          tooltip_div.html("mangroves<br/>")
			          	// Can't position the tooltip for some reason
			        	.style("left", "55px")
            			.style("top", "55px");

            			// Can't use pageX or pageY for tooltip positioning either
			            //.style("left", (d3.event.pageX) + "px")
            			//.style("top", (d3.event.pageY - 28) + "px");;
			        }

				    h.select('#mangroves')
			        	.on('mouseover', handleMouseOver)

			    })
		}



// end here

	</script>    



  </body>
</html>
